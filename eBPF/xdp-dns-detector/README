1. simpledns.c contains a simple code that filters out dns packets on udp port 53


2. This xdp_dns_kern.c is an eBPF/XDP kernel-level DNS packet analyzer. It:
    Filters only UDP packets on port 53 (DNS traffic).
    Parses the DNS query section to:
    Detect suspiciously long subdomain labels (length > 20).
    Detect overly long full domain names (length > 100).
    Logs alerts with bpf_printk for such cases.
    Passes all packets (XDP_PASS) without blocking.
    It helps in detecting DNS tunneling or beaconing behavior.

3. This loader.c program:
   Loads and attaches an XDP program (xdp_dns_kern.o) to a given network interface.
   Steps:
        Takes interface name as input (e.g., eth0).
        Opens and loads the compiled BPF object file.
        Retrieves the XDP program from it.
        Attaches it to the interface using bpf_xdp_attach().
        Waits for Enter key to detach the program before exiting.

  âœ… Purpose: Dynamically manage XDP programs for DNS telemetry.
  ðŸ”Ž Log View: Use sudo cat /sys/kernel/debug/tracing/trace_pipe.

4. This Makefile builds:
      xdp_dns_kern.o: Compiles the XDP kernel program using clang for BPF target.
      loader: Compiles the user-space loader with libbpf, libelf, and zlib.

      ðŸ”§ Targets:
      all: Builds both xdp_dns_kern.o and loader.

      clean: Deletes object files and the loader binary.

      ðŸ›  Dependencies:
      Requires libbpf, clang, libelf, and zlib.
